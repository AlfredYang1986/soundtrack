@(title : String)

@main(title) {
<!--
    <link href="@routes.Assets.at("stylesheets/User_Login.css")" type=text/css rel=stylesheet /> -->
    <link href="@routes.Assets.at("stylesheets/Default.css")" type=text/css rel=stylesheet />
    <link href="@routes.Assets.at("stylesheets/xtree.css")" type=text/css rel=stylesheet />
    <script src="@routes.Assets.at("javascripts/cookie-manager.js")" type="text/javascript"></script>
    <link href="@routes.Assets.at("stylesheets/style.css")" type=text/css rel=stylesheet />

} {


<body>
  <div class="body"></div>
        <div class="grad"></div>
        <br>
        <div class="login">
                <label style="font-size: 18px; color: #F0F3F4;">财商咨询&nbsp;&nbsp;<span style="font-size: 17px; color: #2E86C1;">管理员登录</span></label>
                <input id=TxtUserName type="text" placeholder="用户名" name="user" data-name="text"><br>
                <input id=TxtPassword type="password" placeholder="密码" name="password" data-name="text"><br>
                <input id=IbtnEnter type="button" value="确认登录" onclick='loginFunc()' name=IbtnEnter>
        </div>
</body>

<!--
    <div id="userlogin_body">
        <div></div>

        <div id=user_login>
            <dl>
                <dd id=user_top>
                    <ul>
                        <li class=user_top_l></li>
                        <li class=user_top_c></li>
                        <li class=user_top_r></li>
                    </ul>

            <dd id=user_main>
                <ul>
                    <li class=user_main_l></li>
                    <li class=user_main_c>
                        <div class=user_main_box>
                            <ul>
                                <li class=user_main_text>用户名： </li>
                                <li class=user_main_input>
                                    <input class=TxtUserNameCssClass id=TxtUserName maxLength=20 data-name="text">
                                </li>
                            </ul>

                            <ul>
                                <li class=user_main_text>密 码： </li>
                                <li class=user_main_input>
                                    <input class=TxtPasswordCssClass id=TxtPassword type=password data-name="text">
                                </li>
                            </ul>

                            @*<ul>*@
                                @*<li class=user_main_text>Cookie： </li>*@
                                @*<li class=user_main_input>*@
                                    @*<select id=DropExpiration name=DropExpiration>*@
                                        @*<option value=None selected>不保存</option>*@
                                        @*<option value=Day>保存一天</option>*@
                                        @*<option value=Month>保存一月</option>*@
                                        @*<option value=Year>保存一年</option>*@
                                    @*</select>*@
                                @*</li>*@
                            @*</ul>*@
                        </div>
                    </li>

                    <li class=user_main_r>
                        <input class=IbtnEnterCssClass id=IbtnEnter style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px"
                            onclick='loginFunc()'
                            type=image src="@routes.Assets.at("images/user_botton.gif")" name=IbtnEnter>
                    </li>
                </ul>

                <dd id=user_bottom>
                    <ul>
                        <li class=user_bottom_l></li>
                        <li class=user_bottom_c>
                            <span data-name="user_login_error" style="MARGIN-TOP: 40px">请输入正确的用户名以及密码</span>
                        </li>
                        <li class=user_bottom_r></li>
                    </ul>
                </dd>
            </dl>
        </div>
    </div>
-->


} {
    <script type="text/javascript">

        $(function () {
            $('span[data-name="user_login_error"]').hide();
        });

        function validate(ele, result, name) {
            if (result) $(ele).removeClass('validate-error');
            else $(ele).addClass('validate-error');
            if (name) {
                if (result) $(String(name)).css({"display": "none"});
                else $(String(name)).css({"display": "block"});
            }
            return result;
        }
        function hasInput(str) {
            var result = (typeof(str) == "string") && (str != "");
            return result;
        }

        function loginFunc() {
            var user_name = $('#TxtUserName').val();
            var password = $('#TxtPassword').val();

            var result = true;
            result &= validate($('input[data-name="text"]'), hasInput(user_name) && hasInput(password), 'span[data-name="user_login_error"]');

            if (result) {
                var query_object = new Object();

                query_object['user_name'] = user_name;
                query_object['password'] = password;

                $.ajax({
                    url: "/auth/admin/login",
                    type: 'POST',
                    dataType: 'json',
                    contentType: 'application/json, charset=utf-8',
                    data: JSON.stringify(query_object),
                    cache: false,
                    success: function (data) {
                        if (data.status == "ok") {
                            setCookie("wechat_id", data.result.wechat_id, 1);
                            setCookie("token", data.result.token, 1);
                            setCookie("screen_name", data.result.screen_name, 1);
                            setCookie("screen_photo", data.result.screen_photo, 1);
                            window.location.href = "/admin/index";

                        } else {
                            alert(data.error.message);
                        }
                    },
                    error: function (xhr, status, error) {
                        alert("请检查您的输入");
                    }
                });
            }
        }
    </script>
}